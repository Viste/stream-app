{% extends 'layout.html' %}

{% block head %}
<style>
    .container {
        width: 80%;
        margin: 0 auto;
        background-color: black;
        padding: 20px;
        color: white;
    }

    .video-wrapper {
        padding-top: 20px;
        height: 0;
        position: relative;
        padding-bottom: 56.25%;
    }

    video {
        display: block;
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
    }
</style>
{% endblock %}

{% block title %}Трансляция{% endblock %}

{% block content %}
<div class="container">
    <h1>Трансляция</h1>
    <div class="video-wrapper">
        <video id="video" controls autoplay></video>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
var params = new URLSearchParams(window.location.search);
var url = params.get('url') || "http://185.189.167.41:30180/hls/index.m3u8";
if (Hls.isSupported()) {
    var video = document.getElementById('video');
    var hls = new Hls();
    hls.attachMedia(video);
    hls.on(Hls.Events.MEDIA_ATTACHED, function () {
        hls.loadSource(url);
        hls.on(Hls.Events.MANIFEST_PARSED, function (event, data) {
            video.play();
        });
    });
}
</script>
{% endblock %}